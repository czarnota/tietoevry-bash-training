<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>presentation</title>
    <style>
    * { box-sizing: border-box; }
    .level2, h1 { max-height: 92vh; margin: 1em auto; background: #fff;
              padding: 0; font-size: 12px; aspect-ratio: 16 / 9; padding: 1.5em 1.5em 1.5em 1.5em;
              display: flex; flex-direction: column; overflow: hidden; flex: 1 1 auto;
              box-shadow: 0 0 0.5em #ddd; color: #333; }
    h1 { align-items: center; flex-direction: row; padding: 0.75em; }
    body { margin: 0; padding: 0; font-family: sans-serif; background: rgb(237, 237, 240); }
    h2 { font-size: 2em; color: #005; }
    img { display: block; margin: auto; width: 100%; height: 100%; overflow: hidden; object-fit: contain;}
    section > p, section > ul { margin: 0 0 0.8em 0; line-height: 1.5em;}
    ul { padding-left: 1em; }
    h2 { margin: 0 0 0.4em 0; }

.language-console .gp { color: #6ec071; }

/*

    Name:       Base16 Tomorrow Dark
    Author:     Chris Kempson (http://chriskempson.com)

    Pygments template by Jan T. Sott (https://github.com/idleberg)
    Created with Base16 Builder by Chris Kempson (https://github.com/chriskempson/base16-builder)

*/
.sourceCode .hll { background-color: #373b41; }

.sourceCode { background: #1d1f21; color: #ffffff; }

.sourceCode .co { color: #969896; } /* Comment */
.sourceCode .err { color: #cc6666; }

/* Error */
.sourceCode .kw { color: #b294bb; } /* Keyword */
.sourceCode .cf { color: #b294bb; } /* Keyword */
.sourceCode .l { color: #de935f; }

/* Literal */
.sourceCode .n { color: #ffffff; }

/* Name */
.sourceCode .ot { color: #8abeb7; } /* Operator */
.sourceCode .op { color: #8abeb7; } /* Operator */
.sourceCode .p { color: #ffffff; }

/* Punctuation */
.sourceCode .cm { color: #969896; }

/* Comment.Multiline */
.sourceCode .pp { color: #69AE69; } /* Comment.Preproc */
.sourceCode .im { color: #69AE69; } /* Comment.Preproc */
.sourceCode .c1 { color: #969896; }

/* Comment.Single */
.sourceCode .cs { color: #969896; }

/* Comment.Special */
.sourceCode .gd { color: #cc6666; }

/* Generic.Deleted */
.sourceCode .ge { font-style: italic; }

/* Generic.Emph */
.sourceCode .gh { color: #ffffff; font-weight: bold; }

/* Generic.Heading */
.sourceCode .gi { color: #b5bd68; }

/* Generic.Inserted */
.sourceCode .gp { color: #969896; font-weight: bold; }

/* Generic.Prompt */
.sourceCode .gs { font-weight: bold; } 
/* Generic.Strong */
.sourceCode .gu { color: #8abeb7; font-weight: bold; }

/* Generic.Subheading */
.sourceCode .kc { color: #b294bb; }

/* Keyword.Constant */
.sourceCode .kd { color: #b294bb; }

/* Keyword.Declaration */
.sourceCode .kn { color: #8abeb7; }

/* Keyword.Namespace */
.sourceCode .kp { color: #b294bb; }

/* Keyword.Pseudo */
.sourceCode .kr { color: #b294bb; }

/* Keyword.Reserved */
.sourceCode .dt { color: #f0c674; } /* Keyword.Type */
.sourceCode .ld { color: #b5bd68; }

/* Literal.Date */
.sourceCode .m { color: #de935f; }

/* Literal.Number */
.sourceCode .s { color: #b5bd68; }

/* Literal.String */
.sourceCode .na { color: #81a2be; }

/* Name.Attribute */
.sourceCode .bu { color: #ffffff; } /* Name.Builtin */
.sourceCode .nc { color: #f0c674; }

/* Name.Class */
.sourceCode .no { color: #cc6666; }

/* Name.Constant */
.sourceCode .nd { color: #8abeb7; }

/* Name.Decorator */
.sourceCode .ni { color: #ffffff; }

/* Name.Entity */
.sourceCode .ne { color: #cc6666; }

/* Name.Exception */
.sourceCode .fu { color: #81a2be; } /* Name.Function */

/* Name.Label */
.sourceCode .nn { color: #f0c674; }

/* Name.Namespace */
.sourceCode .nx { color: #81a2be; }

/* Name.Other */
.sourceCode .py { color: #ffffff; }

/* Name.Property */
.sourceCode .nt { color: #8abeb7; }

/* Name.Tag */
.sourceCode .va { color: #cc6666; } /* Name.Variable */
.sourceCode .ow { color: #8abeb7; }

/* Operator.Word */
.sourceCode .w { color: #ffffff; }

/* Text.Whitespace */
.sourceCode .mf { color: #de935f; }

/* Literal.Number.Float */
.sourceCode .mh { color: #de935f; }

/* Literal.Number.Hex */
.sourceCode .dv { color: #de935f; }

/* Literal.Number.Integer */
.sourceCode .mo { color: #de935f; }

/* Literal.Number.Oct */
.sourceCode .sb { color: #b5bd68; }

/* Literal.String.Backtick */
.sourceCode .sc { color: #ffffff; }

/* Literal.String.Char */
.sourceCode .sd { color: #969896; }

/* x Literal.String.Doc */
.sourceCode .st { color: #b5bd68; }

/* Literal.String.Double */
.sourceCode .sc { color: #de935f; } 
/* Literal.String.Escape */
.sourceCode .sh { color: #b5bd68; }

/* Literal.String.Heredoc */
.sourceCode .si { color: #de935f; }

/* Literal.String.Interpol */
.sourceCode .sx { color: #b5bd68; }

/* Literal.String.Other */
.sourceCode .sr { color: #b5bd68; }

/* Literal.String.Regex */
.sourceCode .s1 { color: #b5bd68; }

/* Literal.String.Single */
.sourceCode .ss { color: #b5bd68; }

/* Literal.String.Symbol */
.sourceCode .bp { color: #ffffff; }

/* Name.Builtin.Pseudo */
.sourceCode .vc { color: #cc6666; }

/* Name.Variable.Class */
.sourceCode .vg { color: #cc6666; }

/* Name.Variable.Global */
.sourceCode .vi { color: #cc6666; }

/* Name.Variable.Instance */
.sourceCode .il { color: #de935f; }

/* Literal.Number.Integer.Long */

div.sourceCode { vertical-align: top; margin: 0 0 0.8em 0; }

pre {
  font-family: monospace;
  font-size: 0.8em;
  margin: 0 0 0.8em 0;
}

.sourceCode a { color: #fff }

.sourceCode pre {
    padding: 0;
    margin: 0;
}

pre code {
  display: block;
  padding: 1em 1.25em;
  overflow-x: auto;
  background: #1d1f21;
  color: #ffffff;
}
      .sourceCode pre code::-webkit-scrollbar {
        -webkit-appearance: none; }
      .sourceCode pre code::-webkit-scrollbar:vertical {
        width: 10px; }
      .sourceCode pre code::-webkit-scrollbar:horizontal {
        height: 10px; }
      .sourceCode pre code::-webkit-scrollbar-thumb {
        background-color: #555; }
      .sourceCode pre code::-webkit-scrollbar-track {
        background-color: #333; }
  .sourceCode::selection {
    background: #fff;
    /* WebKit/Blink Browsers */
    color: #000; }
  .sourceCode::-moz-selection {
    background: #fff;
    /* Gecko Browsers */
    color: #000; }

p > code, li > code {
  background: #fff;
  padding: 0.1em 0.2em;
  box-shadow: 0 2px 4px 0 #ddd;
  border: 1px solid #ddd; }

    </style>
    <link rel="stylesheet" href="assets/styles.css" />
  </head>
  <body>
<section id="bash-training" class="level1">
<h1>Bash training</h1>
<section id="bash" class="level2">
<h2>Bash</h2>
<p>Bash is an Unix shell and command language written for the GNU Project</p>
<p><img src="assets/bash.png" /></p>
</section>
<section id="system-shell" class="level2">
<h2>System shell</h2>
<p><strong>System shell</strong> is a computer program, which acts as an interface between operating system, applications and the user. Using the shell, user can interact with the operating system e.g. <strong>run processes</strong>, perform operations on files, change system settings etc.</p>
<p><img src="assets/0.svg" /></p>
</section>
<section id="examples-of-system-shells---windows-file-explorer" class="level2">
<h2>Examples of system shells - Windows File Explorer</h2>
<p>File Explorer is an application, which allows user to open files and run processes. It is an example of a graphical system shell.</p>
<p><img src="assets/fileexplorer.jpg" /></p>
</section>
<section id="examples-of-system-shells---xbox-series-x-dashboard" class="level2">
<h2>Examples of system shells - Xbox Series X dashboard</h2>
<p>The purpose of Xbox dashboard is to run processes (games), therefore it can also be considered as an example of a graphical system shell.</p>
<p><img src="assets/xoneshell.jpg" /></p>
</section>
<section id="examples-of-system-shells---bash" class="level2">
<h2>Examples of system shells - Bash</h2>
<p>Bash is an example of a command-line shell. Other example of command line shells include i. a. <code>zsh</code>, <code>tcsh</code>, <code>busybox ash</code> and <code>fish</code> shell.</p>
<p><img src="assets/bashshell.png" /></p>
</section>
<section id="question-why-do-we-still-use-a-command-line-interface" class="level2">
<h2>Question: Why do we still use a command-line interface?</h2>
<p>Why in the era of graphical user interfaces and amazing user experiences programmers still work using the “ancient” command line interface?</p>
<ul class="incremental">
<li>Do they want to show off?</li>
<li>Are they nerds?</li>
<li>Are they insane people?</li>
</ul>
</section>
<section id="answer-why-do-we-still-use-a-command-line-interface" class="level2">
<h2>Answer: Why do we still use a command-line interface?</h2>
<ul class="incremental">
<li><strong>It is easier to show what you did to others</strong>. You can send a list of commands to the other person instead of screenshots.</li>
<li><strong>It is natural to automate</strong>. What you type can be placed in a text file and you can run it again.</li>
<li><strong>It is faster to write command line applications</strong>. Compare <code>echo hello world</code> with a “Hello World application” in any GUI framework.</li>
</ul>
</section>
<section id="running-programs" class="level2">
<h2>Running programs</h2>
<p>Using Bash system shell we can run processes by typing program names.</p>
<pre class="console"><code>$ PROGRAM_NAME ARGUMENTS...</code></pre>
<p>For example if we want to run a <code>ls</code> program, we can type:</p>
<pre><code>$ ls -l -a /home</code></pre>
</section>
<section id="example-programs---filesystem-operations" class="level2">
<h2>Example programs - filesystem operations</h2>
<p>Examples of programs that manage files and directories:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span> p0             # print p0 to standard output</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span> p0 p1 p2       # print p0, p1 and p2 to standard output</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> x               # remove file</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> -fr a           # remove file or directory <span class="st">&quot;recursively&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> d0              # print a list of files in <span class="st">&#39;d0&#39;</span> directory</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> -a d0           # print a list of files in <span class="st">&#39;d0&#39;</span> directory including hidden files</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> -l d0           # print a more detailed list of files in <span class="st">&#39;d0&#39;</span> directory</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mv</span> a b             # rename file from <span class="st">&#39;a&#39;</span> to <span class="st">&#39;b&#39;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cp</span> a b             # copy <span class="st">&#39;a&#39;</span> file to <span class="st">&#39;b&#39;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cp</span> -r a b          # copy <span class="st">&#39;a&#39;</span> directory to <span class="st">&#39;b&#39;</span> recursively</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cp</span> a b c d         # copy <span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span> into <span class="st">&#39;d&#39;</span> directory</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">touch</span> x            # change <span class="st">&#39;x&#39;</span> file timestamps</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">touch</span> -c x         # change <span class="st">&#39;x&#39;</span> file timestamps, but do not create a file</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mkdir</span> a            # create directory name <span class="st">&#39;a&#39;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mkdir</span> -p a/b/c     # create <span class="st">&#39;a/b/c&#39;</span> directory hierarchy</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rmdir</span> a            # remove empty directory</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ln</span> a b             # create hard link named <span class="st">&#39;b&#39;</span> to <span class="st">&#39;a&#39;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ln</span> -s a b          # create soft link named <span class="st">&#39;b&#39;</span> to <span class="st">&#39;a&#39;</span></span></code></pre></div>
</section>
<section id="example-programs---access-control" class="level2">
<h2>Example programs - access control</h2>
<p>Examples of programs that manage file and directory permissions:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">chmod</span> 777 f         # change <span class="st">&#39;f&#39;</span> permissions to 777</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">chmod</span> u+x,g+x,o+x   # add execute permission to user, group and others</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">chown</span> user a        # change owner of <span class="st">&#39;a&#39;</span> to <span class="st">&#39;user&#39;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">chown</span> group:user a  # change group to <span class="st">&#39;gruop&#39;</span> and owner of <span class="st">&#39;a&#39;</span> to <span class="st">&#39;user&#39;</span></span></code></pre></div>
</section>
<section id="example-programs---archive-management" class="level2">
<h2>Example programs - archive management</h2>
<p>Examples of programs that manage archives:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> -tf archive.tar.gz             # print (t) <span class="ex">files</span> in archive (f)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> -xzvf archive.tar.gz           # extract (x) <span class="ex">.gz</span> (z) <span class="ex">archive</span>, verbosely (v)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> -xjvf archive.tar.bz2 -C dir   # extract (x) <span class="ex">.bz2</span> (j) <span class="ex">archive</span>, verbosely (v) <span class="ex">to</span> <span class="st">&#39;dir&#39;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> -cf archive.tar f1 f2 d0       # create (c) <span class="fu">tar</span> archive with files (f) <span class="ex">f1</span> f2 d0</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> -cjvpf archive.tar.bz2 f1 f2   # create bz2 (j) <span class="ex">verbosely</span> (v), <span class="ex">preserving</span> permissions (p)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">zip</span> x.zip f0                       # create <span class="st">&#39;x.zip&#39;</span> archive containing <span class="st">&#39;f0&#39;</span> file</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">zip</span> -r x.zip d0                    # create <span class="st">&#39;x.zip&#39;</span> archive containing <span class="st">&#39;d0&#39;</span> directory</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">unzip</span> x.zip                        # unzip <span class="st">&#39;x.zip&#39;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">unzip</span> -l x.zip                     # print files in <span class="st">&#39;x.zip&#39;</span> archive</span></code></pre></div>
</section>
<section id="question-what-is-the-difference-between-a-symbolic-link-and-a-hard-link" class="level2">
<h2>Question: What is the difference between a symbolic link and a hard link?</h2>
<p>We can create symbolic links using <code>ln</code> program.</p>
<pre class="console"><code>$ ln target destination</code></pre>
<p>We can create hard links using <code>ln</code> program and <code>-s</code> option.</p>
<pre class="console"><code>$ ln -s target destination</code></pre>
<p>What is the difference?</p>
</section>
<section id="answer-what-is-the-difference-between-a-symbolic-link-and-a-hard-link" class="level2">
<h2>Answer: What is the difference between a symbolic link and a hard link?</h2>
<pre><code>$ ln bar foo</code></pre>
<pre><code>$ ln -s bar baz</code></pre>
<p><img src="assets/1.svg" /></p>
</section>
<section id="task-the-land-of-tietoevry" class="level2">
<h2>Task: The Land of TietoEvry</h2>
<p>Download the following archive using <code>wget</code> program.</p>
<pre><code>$ wget czarnota.github.io/data/task-land.tar.gz</code></pre>
<ol class="incremental" type="1">
<li>Extract the archive.</li>
<li>Complete all listed missions</li>
<li>Create a <code>.tar.gz</code> archive from the directory.</li>
</ol>
</section>
</section>
<section id="options-and-arguments" class="level1">
<h1>Options and arguments</h1>
<section id="options-and-arguments-1" class="level2">
<h2>Options and arguments</h2>
<p>All characters (with the exception of a few built-in bash constructs/operators) following the program’s name are interpreted by the program and can influence its behavior.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">PROGRAM_NAME</span> ARGUMENTS...</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">chmod</span> o+w,g+w file</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">find</span> . <span class="dt">\(</span> -name words -or -name x <span class="dt">\)</span> -and -not -executable</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">tcpdump</span> -i eth0 ip or arp</span></code></pre></div>
</section>
<section id="posix-syntax" class="level2">
<h2>POSIX Syntax</h2>
<p>Programs can parse options and arguments as they like, but there exists a common convention that most Unix programs follow. This convention is standarised by POSIX.</p>
<p>In the below example, <code>-a</code> is an option, <code>-b barg</code> is an option with an argument <code>barg</code> and <code>arg0</code> and <code>arg1</code> are just arguments.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">prog</span> -a -b barg arg0 arg1 # The <span class="st">&#39;barg&#39;</span> is an argument to the -b option</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">prog</span> -ab barg arg0 arg1   # You can <span class="st">&quot;glue&quot;</span> options together</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">prog</span> -a -- -b barg arg1   # You can terminate options using --, here -b is an argument</span></code></pre></div>
<p>For example, the below two commands are equivalent:</p>
<pre class="console"><code>$ tar -x -z -v -f arch.tar.gz 
$ tar -xzvfarch.tar.gz</code></pre>
</section>
<section id="extended-gnu-syntax" class="level2">
<h2>Extended GNU Syntax</h2>
<p>GNU introduced long options (supported using <code>getopt_long()</code> and <code>getopt_long_only()</code> C library functions).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">prog</span> -ab --option --key=value arg0 arg1 arg2   # getopt_long()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">prog</span> -option -key arg0 arg1 arg2               # getopt_long_only()</span></code></pre></div>
<p>Examples of long options:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ps</span> --user             # getopt_long()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> --all              # getopt_long()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">find</span> . -name x        # getopt_long_only()</span></code></pre></div>
</section>
<section id="legacy-bsd-syntax" class="level2">
<h2>Legacy BSD Syntax</h2>
<p>Convention that <code>ps</code> manual page calls a <code>BSD Syntax</code>. It is supported only by a few programs.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">prog</span> ab arg0 arg1 arg2     # options are: <span class="st">&#39;a&#39;</span> and <span class="st">&#39;b&#39;</span>, the rest are arguments</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">prog</span> abcdef arg0 arg1 arg2 # options are: <span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, the rest are arguments</span></code></pre></div>
<p>Examples:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ps</span> aux</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> xzvf arch.tar.gz</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> czf files.tar.gz file1 file2</span></code></pre></div>
</section>
<section id="command-syntax---conclusion" class="level2">
<h2>Command syntax - conclusion</h2>
<p>It is important to note that the options and arguments are interpreted by the executed program and not by the shell. For example, if we execute <code>ls</code>:</p>
<pre><code>$ ls -l -a /home</code></pre>
<p>Then the <code>ls</code> program would receive the following arguments in its <code>main()</code> function:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> **argv)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// argv = { &quot;ls&quot;, &quot;-l&quot;, &quot;-a&quot;, &quot;/home&quot; }</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// argc = 4</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Bash only splits the input line into tokens.</strong></p>
</section>
<section id="question-which-is-correct" class="level2">
<h2>Question: Which is correct?</h2>
<p>Which commands would you use to create directory called <code>-f</code>, list its contents and then remove it afterwards?</p>
<p>These commands:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mkdir</span> -f</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> -f</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> -fr -f</span></code></pre></div>
<p>Or these:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mkdir</span> <span class="st">&quot;-f&quot;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> <span class="st">&quot;-f&quot;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> -fr <span class="st">&quot;-f&quot;</span></span></code></pre></div>
</section>
<section id="answer-which-is-correct" class="level2">
<h2>Answer: Which is correct?</h2>
<p>Neither. The quotes <code>""</code> make no difference to the executed program. It will still see <code>-f</code> in its argument list. We need to use <code>--</code> to terminate the list of options.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mkdir</span> -- <span class="st">&quot;-f&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> -- <span class="st">&quot;-f&quot;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> -fr -- <span class="st">&quot;-f&quot;</span></span></code></pre></div>
</section>
<section id="example-programs---find" class="level2">
<h2>Example programs - find</h2>
<p>The <code>find</code> program searches for files and directories. For example to find all files named <code>lib_functions.c</code> starting our search from the current working directory <code>.</code>, we can do:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">find</span> . -name <span class="st">&quot;lib_functions.c&quot;</span></span></code></pre></div>
<p>We can search in a case insensitive mode, also using wildcard patterns. The below example will print all files that start with string <code>host</code> (case insensitive). Also, it will not print any directories (<code>-type f</code>).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">find</span> / -iname <span class="st">&quot;host*&quot;</span> -type f</span></code></pre></div>
<p>We can execute a program on each file with <code>.tmp</code> extension. The below command will remove all <code>.tmp</code> files, but will prompt for confirmation before removal (<code>rm -i</code>):</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">find</span> . -name <span class="st">&quot;*.tmp&quot;</span> -exec rm -i {} <span class="dt">\;</span></span></code></pre></div>
</section>
<section id="task-svg-to-png-converter" class="level2">
<h2>Task: SVG to PNG converter</h2>
<p>Download and extract, using the terminal:</p>
<pre><code>https://github.com/simple-icons/archive/develop.zip</code></pre>
<ol class="incremental" type="1">
<li>Convert all <code>.svg</code> icons starting <strong>with the same letter as your surname</strong> into <code>.png</code> files.</li>
<li>Pack converted files into a <code>.zip</code> archive</li>
</ol>
<p>Hints:</p>
<ul class="incremental">
<li><code>find</code> - will allow you to execute a program on selected files;</li>
<li><code>inkscape</code> - will allow you to convert <code>.svg</code> to <code>.png</code>;</li>
<li><code>zip</code> - will allow you to create a <code>.zip</code> archive.</li>
</ul>
</section>
</section>
<section id="processes" class="level1">
<h1>Processes</h1>
<section id="the-difference-between-a-program-and-a-process" class="level2">
<h2>The difference between a program and a process</h2>
<p>A process is a program that is being executed.</p>
<p>Program is a list of instructions to be executed (just like a cooking recipe) and a process is an act of executing these instructions (just like cooking). <img src="assets/programandprocess.png" /></p>
</section>
<section id="what-is-a-proces" class="level2">
<h2>What is a proces</h2>
<p>A process is a program that is being executed. It consists of:</p>
<ul class="incremental">
<li><strong>Processor state (registers)</strong> For <code>x86_64</code> these are i. a:
<ul class="incremental">
<li><code>rbp</code> - base of the stack (frame pointer);</li>
<li><code>rsp</code> - stack pointer;</li>
<li><code>rip</code> - program counter;</li>
<li><code>rflags</code> - flags register;</li>
<li>general purpose registers: <code>rax</code>, <code>rcx</code>, <code>rdx</code>, <code>rbx</code>, <code>rsi</code>, <code>rdi</code>, <code>r8</code>-<code>r15</code>.</li>
</ul></li>
<li><strong>Virtual memory</strong> (Page table) (pointer by <code>CR3</code> register).</li>
<li><strong>Open file descriptors</strong>, for example:
<ul class="incremental">
<li>regular files (opened by <code>open()</code>);</li>
<li>network sockets (opened by <code>socket()</code>, <code>accept()</code>);</li>
<li>pipes (opened by <code>pipe()</code>).</li>
</ul></li>
<li>Other data structure important for Linux kernel.</li>
</ul>
</section>
<section id="how-linux-represents-processes" class="level2">
<h2>How Linux represents processes?</h2>
<p>In Linux kernel every process is represented by a <code>struct task_struct</code>.</p>
<p>Below are some fields located in this structure:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> task_struct {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> list_head tasks           <span class="co">/* An entry on a process list */</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    pid_t pid;                       <span class="co">/* Process identifies (PID)  */</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> mm_struct *mm             <span class="co">/* Process memory */</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> task_struct *real_parent; <span class="co">/* The real parent - the one who called clone() */</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> task_struct *parent;      <span class="co">/* Receiver of SIGCHLD i wait4() */</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> list_head children;       <span class="co">/* Process&#39; children */</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> sigpending pending;       <span class="co">/* List of pending signals */</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> files_struct *files;      <span class="co">/* Open file descriptors */</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> *stack                      <span class="co">/* Pointer to kernel stack of the process </span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">                                        - on x86_64 the state of registers is</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">                                          stored here */</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>};</span></code></pre></div>
</section>
<section id="process-list" class="level2">
<h2>Process list</h2>
<p>Linux internally keeps a circular list of all processes running in the system.</p>
<p><img src="assets/12.svg" /></p>
</section>
<section id="how-can-we-check-which-processes-are-running-at-the-moment" class="level2">
<h2>How can we check which processes are running at the moment</h2>
<p>The <code>ps</code> program can show us all processes, the <code>top</code> program displays processes interactively, the <code>pstree</code> prints a tree of processes and the pseudo file system <code>/proc</code> contains entries representing every process.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ps</span> aux</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">top</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">pstree</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> /proc</span></code></pre></div>
</section>
<section id="running-processes-in-bash---how-does-it-work" class="level2">
<h2>Running processes in Bash - how does it work</h2>
<p>A primitive system shell could be implemented like this:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (true) {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> *line = readline(<span class="st">&quot;$ &quot;</span>);</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> *my_argv[<span class="dv">12</span>] = {<span class="dv">0</span>};</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (!parse_line(line, my_argv, ARRAY_SIZE(my_argv) - <span class="dv">1</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">goto</span> out;</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pid = fork();</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (pid == <span class="dv">0</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        execvp(my_argv[<span class="dv">0</span>], my_argv);</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> status;</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    waitpid(pid, &amp;status, <span class="dv">0</span>);</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    report(status);</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>out:</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    free(line);</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="running-processes-in-background" class="level2">
<h2>Running processes in background</h2>
<p>In <code>ls &amp;</code> command, the <code>&amp;</code> will run the process in the background. It omits the call to <code>waitpid()</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (true) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> *line = readline(<span class="st">&quot;$ &quot;</span>);</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> *my_argv[<span class="dv">12</span>] = {<span class="dv">0</span>};</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (!parse_line(line, my_argv, ARRAY_SIZE(my_argv) - <span class="dv">1</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">goto</span> out;</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pid = fork();</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (pid == <span class="dv">0</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        execvp(my_argv[<span class="dv">0</span>], my_argv);</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> status;</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (in_background(line))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        status = <span class="dv">0</span>;</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        waitpid(pid, &amp;status, <span class="dv">0</span>);</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    report(status);</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>out:</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    free(line);</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="question-if-we-omit-waitpid-and-bash-is-still-running-why-there-are-no-zombie-processes" class="level2">
<h2>Question: If we omit <code>waitpid()</code> and bash is still running, why there are no zombie processes?</h2>
<p>After all, this is how zombie processes are created.</p>
<p>What are we missing?</p>
</section>
<section id="answer-if-we-omit-waitpid-and-bash-is-still-running-why-there-are-no-zombie-processes" class="level2">
<h2>Answer: If we omit <code>waitpid()</code> and bash is still running, why there are no zombie processes?</h2>
<p>When a child process finishes, the parent is notified with <code>SIGCHLD</code>. Bash calls <code>wait</code> system call in <code>SIGCHLD</code> handler, which allows to read process exit code and remove it from the list of processes.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* sigchld_handler () flushes at least one of the children that we are</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">   waiting for.  It gets run when we have gotten a SIGCHLD signal. */</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> sighandler sigchld_handler(<span class="dt">int</span> sig) {</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n, oerrno;</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    oerrno = errno;</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    REINSTALL_SIGCHLD_HANDLER;</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    sigchld++;</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    n = <span class="dv">0</span>;</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (queue_sigchld == <span class="dv">0</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        n = waitchld (-<span class="dv">1</span>, <span class="dv">0</span>);</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    errno = oerrno;</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    SIGRETURN (n);</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="question-will-zombie-process-be-created" class="level2">
<h2>Question: Will zombie process be created?</h2>
<p>The <code>exec</code> command calls one of <code>exec*()</code> system calls, which causes the current process to execute a different program, by replacing the code section of the current process and reinitializing the process memory.</p>
<p>The <code>/usr/bin/sleep</code> simply waits the specified number of seconds.</p>
<p>The questions are:</p>
<ul class="incremental">
<li><strong>Will zombie process be created in the below case?</strong></li>
<li><strong>If so, then why will it be created?</strong></li>
<li><strong>If so, how long will it exist in a zombie state?</strong></li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">/usr/bin/sleep</span> 5 <span class="kw">&amp;</span>        </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">exec</span> /usr/bin/sleep 3600</span></code></pre></div>
</section>
<section id="answer-will-zombie-process-be-created" class="level2">
<h2>Answer: Will zombie process be created?</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">/usr/bin/sleep</span> 5 <span class="kw">&amp;</span>         # <span class="ex">spawn</span> child</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">exec</span> /usr/bin/sleep 3600   # replace bash with sleep - erases signal handler</span></code></pre></div>
<p>Answers:</p>
<ul class="incremental">
<li><strong>Will zombie process be created in the below case?</strong>
<ul class="incremental">
<li>Yes.</li>
</ul></li>
<li><strong>Why will it be created?</strong>
<ul class="incremental">
<li>Because <code>sleep</code> does not implement <code>SIGCHLD</code> signal handler.</li>
</ul></li>
<li><strong>How long will it exist in a zombie state?</strong>
<ul class="incremental">
<li>The child executes for <code>5</code> seconds, the parent for <code>3600</code> seconds. The child will be in zombie state for <code>3595</code> seconds.</li>
</ul></li>
</ul>
</section>
<section id="detaching-processes-from-the-shell" class="level2">
<h2>Detaching processes from the shell</h2>
<p>Runs <code>COMMAND</code>, redirects <code>stdout</code> and <code>stderr</code> to files in order to avoid termination from a closed terminal and removes the process identified by <code>PID</code> from the Bash job list, which will prevent Bash from propagating <code>SIGHUP</code>:</p>
<pre><code>$ COMMAND &gt;file 2&gt;file &amp;
$ disown PID</code></pre>
<p>Runs <code>COMMAND</code>, but prevents it from receiving <code>SIGHUP</code>, also redirects the <code>stdin</code> and <code>stdout</code>:</p>
<pre><code>$ nohup COMMAND &amp;</code></pre>
<p>Runs process with the help of <code>screen</code> program, which thanks to <code>-d</code> option will disconnect itself from the Bash process:</p>
<pre><code>$ screen -d -m COMMAND</code></pre>
</section>
<section id="example-programs---watch" class="level2">
<h2>Example programs - <code>watch</code></h2>
<p>Executes a program periodically, showing output fullscreen.</p>
<p>Show processes periodically:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">watch</span> ps aux</span></code></pre></div>
<p>Show memory usage in real time:</p>
<pre class="bas"><code>$ watch -n0 df</code></pre>
</section>
<section id="task-detaching-from-the-terminal" class="level2">
<h2>Task: Detaching from the terminal</h2>
<ol class="incremental" type="1">
<li>Run <code>tar</code> program so that it would compress the selected directory located in the home directory into <code>~/archive.tar.gz</code> every minute. The process should not be terminated after closing the terminal.</li>
<li>If the process survived after closing the terminal, kill it with <code>kill</code> program.</li>
</ol>
<p>You can get the <code>PID</code> of the process using <code>ps</code> program or <code>pidof</code>.</p>
</section>
</section>
<section id="input-and-output" class="level1">
<h1>Input and output</h1>
<section id="standard-input-output-and-error" class="level2">
<h2>Standard input, output and error</h2>
<p>Bash is started with 3 file descriptors open, pointing to the terminal, numbered <code>0</code>, <code>1</code> and <code>2</code>. They are called standard input, standard output and standard error stream.</p>
<p>The <code>cat</code> program will block, waiting for input from <code>0</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span></span></code></pre></div>
<p>The <code>echo</code> program will write to <code>1</code>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> hello</span></code></pre></div>
<p>The <code>ls</code> program will write errors to <code>2</code></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> --cookies</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ls</span>: unrecognized option <span class="st">&#39;--cookies&#39;</span></span></code></pre></div>
</section>
<section id="redirecting-input" class="level2">
<h2>Redirecting input</h2>
<p>You can start process with a file descriptor pointing to a file instead of a terminal</p>
<p>Start <code>cat</code> with <code>foo</code> file as standard input</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span> <span class="op">&lt;</span> foo</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bar</span></span></code></pre></div>
<p>Start <code>echo</code> with <code>foo</code> file as standard output</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> bar <span class="op">&gt;</span> foo    # will create ovewrite the <span class="st">&#39;foo&#39;</span> file</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> bar <span class="op">&gt;&gt;</span> foo   # will append to the <span class="kw">`</span><span class="ex">foo</span><span class="kw">`</span> file</span></code></pre></div>
<p>Start <code>ls</code> with <code>foo</code> file as standard error stream.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> --cookies <span class="op">2&gt;</span> foo</span></code></pre></div>
</section>
<section id="opening-other-file-descriptos" class="level2">
<h2>Opening other file descriptos</h2>
<p>The <code>0</code>, <code>1</code> and <code>2</code> are just arbitrary numbers. You can open other file descriptors if you want.</p>
<p>Run <code>echo</code> process with file descriptor <code>5</code> pointing to <code>foo</code> file.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> bar <span class="op">5&gt;</span>foo</span></code></pre></div>
<p>Run <code>read</code> command with file descriptor <code>13</code> pointing to <code>foo</code> file and read a line from descriptor <code>13</code> into variable <code>bar</code></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">read</span> -u 13 <span class="va">bar</span> 13<span class="op">&lt;</span> <span class="ex">foo</span></span></code></pre></div>
</section>
<section id="heredoc" class="level2">
<h2>HEREDOC</h2>
<p>You can run a child process with the standard input pointing to temporary file created by <code>bash</code> with desired contents:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>abcdef</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>abcdef</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="ex">abcdef</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="ex">abcdef</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span> -l /proc/self/fd <span class="op">&lt;&lt;&lt;</span> <span class="st">&quot;foo&quot;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="ex">lr-x------</span> 64 jane 21 mar  0:18 0 -<span class="op">&gt;</span> /tmp/sh-thd.PCaGIA (deleted)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwx------</span> 64 jane 21 mar  0:18 1 -<span class="op">&gt;</span> /dev/pts/9</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwx------</span> 64 jane 21 mar  0:18 2 -<span class="op">&gt;</span> /dev/pts/9</span></code></pre></div>
</section>
<section id="what-stdin-stdout-and-stderr-really-are" class="level2">
<h2>What stdin, stdout and stderr really are?</h2>
<p>You can check the opened file descriptors of a <code>bash</code> process in the following way:</p>
<pre><code>$ ls -l /proc/$(pidof -s bash)/fd
lrwx------ 64 john 20 mar 22:13 0 -&gt; /dev/pts/9
lrwx------ 64 john 20 mar 22:13 1 -&gt; /dev/pts/9
lrwx------ 64 john 20 mar 22:13 2 -&gt; /dev/pts/9
lrwx------ 64 john 20 mar 23:20 255 -&gt; /dev/pts/9</code></pre>
<p>As you can see three open file descriptors, stdin (<code>0</code>), stdout (<code>1</code>) and stderr (<code>2</code>), point to <code>/dev/pts/9</code>, which is a <strong>pseudoterminal slave</strong>.</p>
<p>These are examples of an character device. A character device acts like a regular file, but instead of accessing the hard drive, a different specific functionality will be invoked in the kernel, when you write and read from it.</p>
</section>
<section id="the-pseudoterminal-master-and-slave" class="level2">
<h2>The pseudoterminal master and slave</h2>
<p>The terminal emulator opens the <code>/dev/ptmx</code>, creates a pseudoterminal slave <code>/dev/pts/X</code>, forks a child bash process with <code>0</code>, <code>1</code> and <code>2</code> file descriptors set to <code>/dev/pts/X</code>.</p>
<p><img src="assets/pseudoterminal.svg" /></p>
</section>
<section id="question-can-you-open-a-file-in-a-bash-process" class="level2">
<h2>Question: Can you open a file in a <code>bash</code> process?</h2>
<p>In other words how can we open a file directly in <code>bash</code> process?</p>
<p>Is there an equivalent of:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fd = open(<span class="st">&quot;foo.txt&quot;</span>, O_RDONLY, <span class="dv">0</span>);</span></code></pre></div>
<p>?</p>
</section>
<section id="answer-can-you-open-a-file-in-a-bash-process" class="level2">
<h2>Answer: Can you open a file in a <code>bash</code> process?</h2>
<p>You can use <code>exec</code> command.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">exec</span> <span class="op">44&lt;</span> foo      # calls open(<span class="st">&quot;foo&quot;</span>, O_RDONLY, 0)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">read</span> <span class="va">line</span> <span class="op">&lt;&amp;44</span>    # <span class="ex">calls</span> read(44, ...)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">read</span> <span class="va">line</span> <span class="op">&lt;&amp;44</span>    # <span class="ex">calls</span> read(44, ...)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">exec</span> <span class="op">44&lt;</span><span class="kw">&amp;</span> <span class="ex">-</span>       # calls close(44)</span></code></pre></div>
<p>Writing is also possible:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">exec</span> <span class="op">44&gt;</span> foo      # calls open(<span class="st">&quot;foo&quot;</span>, O_WRONLY, 0)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> line <span class="op">&gt;&amp;44</span>    # calls write(44, ...)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> line <span class="op">&gt;&amp;44</span>    # calls write(44, ...)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">exec</span> <span class="op">44&gt;</span><span class="kw">&amp;</span> <span class="ex">-</span>       # calls close(44)</span></code></pre></div>
</section>
<section id="question-what-happens-if-you-close-file-descriptor-2-for-bash-process" class="level2">
<h2>Question: What happens if you close file descriptor 2 for bash process</h2>
<p>Try this command:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">exec</span> <span class="op">2&gt;</span><span class="kw">&amp;</span><span class="ex">-</span></span></code></pre></div>
<p>Then type:</p>
<pre><code>ls&lt;enter&gt;</code></pre>
</section>
<section id="answer-what-happens-if-you-close-file-descriptor-2-for-bash-process" class="level2">
<h2>Answer: What happens if you close file descriptor 2 for bash process</h2>
<p>Bash prints its prompt to descriptor <code>2</code> (standard error stream). So if we close it, we will see no prompt. But we standard input is still open, and also standard output, so typing <code>ls&lt;enter&gt;</code> is returns the directory listing.</p>
</section>
</section>
<section id="pipes" class="level1">
<h1>Pipes</h1>
<section id="the-unix-philosophy" class="level2">
<h2>The Unix philosophy</h2>
<ol class="incremental" type="1">
<li>Write programs that <strong>do one thing and do it well</strong></li>
<li>Write <strong>programs</strong> to <strong>work together</strong></li>
<li>Write programs to handle <strong>text</strong> streams, because that <strong>is an universal interface</strong></li>
</ol>
<p>To realize this philosophy we need pipes.</p>
</section>
<section id="the-concept-of-pipe" class="level2">
<h2>The concept of pipe</h2>
<p>The <code>|</code> operator creates a <code>pipe</code> between 2 processes.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span> foo.txt <span class="kw">|</span> <span class="fu">grep</span> bar</span></code></pre></div>
<p>The <code>pipe</code> endpoints are connected to descriptor <code>1</code> of the first process and <code>0</code> of the second process.</p>
<p><img src="assets/pipe.svg" /></p>
</section>
<section id="examples" class="level2">
<h2>Examples</h2>
<p>Count lines in a file</p>
<pre><code>$ cat file | wc -l</code></pre>
<p>Replace ‘small’ with ‘BIG’</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> small <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/small/BIG&quot;</span></span></code></pre></div>
<p>Remove all <code>.txt</code> files in current working directory and child directories</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">find</span> . -name <span class="st">&quot;*.txt&quot;</span> <span class="kw">|</span> <span class="fu">xargs</span> -rm -f</span></code></pre></div>
</section>
<section id="example-programs---often-used-in-pipes" class="level2">
<h2>Example programs - often used in pipes</h2>
<p>Below are programs that are most useful with pipes:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">wc</span> -l             # count number of lines in standard input</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">xargs</span> -n1 CMD     # execute CMD for each token from standard input</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span>               # pass everything from standard input to standard output</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">grep</span> pattern      # print to standard output only lines that contain <span class="st">&#39;pattern&#39;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">sed</span> <span class="st">&#39;s/a/B/&#39;</span>      # replace <span class="st">&#39;a&#39;</span> with <span class="st">&#39;B&#39;</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">head</span> -n 20        # print first 20 lines</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tail</span>              # print last 20 lines</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">less</span>              # view contents of standard input interactively</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">more</span>              # view contents of standard input interactively (you can<span class="st">&#39;t go back)</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="st">$ most              # view contents of standard input interactively (you can go sideways)</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="st">$ tr x              # replace &#39;</span>x<span class="st">&#39; with &#39;</span>X<span class="st">&#39;</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="st">$ bc                # An arbitrary precision calculator</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="st">$ yes               # Prints &#39;</span>y<span class="st">&#39; to standard output</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="st">$ cut               # remove section from each line of files</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="st">$ tee               # read from standard input and write to standard output and files</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="st">$ xclip             # copy standard input to clipboard</span></span></code></pre></div>
</section>
<section id="task-covid-prompt" class="level2">
<h2>Task: Covid prompt</h2>
<p>Modify your <code>~/.bashrc</code> so that you can see a live counter of total COVID cases world wide in your prompt. Create a tiny script that will run <code>curl</code> (in background), which will save current cases from the API in the <code>~/.cases</code> file. Then use <code>cat</code> to display it in the prompt.</p>
<pre><code>curl --location -s --request GET &#39;https://api.covid19api.com/summary&#39;</code></pre>
<p>You can modify your prompt in <code>.bashrc</code></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">foo ()</span> <span class="kw">{</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">PS1=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> ~/.cases<span class="va">)</span><span class="st"> </span><span class="dt">\$</span><span class="st">&quot;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="va">PROMPT_COMMAND=</span>foo</span></code></pre></div>
<p>You will most likely need <code>jq</code> to parse <code>.json</code> or maybe <code>grep</code>.</p>
</section>
</section>
<section id="subshells" class="level1">
<h1>Subshells</h1>
<section id="what-is-a-subshell" class="level2">
<h2>What is a subshell?</h2>
<p>A subshell is a child Bash process, which is spawned to execute a given command. Below you can see example operators that will cause Bash to create a subshell</p>
<pre><code>(  )</code></pre>
<pre><code>&lt;(  )</code></pre>
<pre><code>$(  )</code></pre>
<pre><code>&gt;(  )</code></pre>
<pre><code>|</code></pre>
</section>
<section id="question-what-is-the-difference-when-we-run-ls-in-a-subshell" class="level2">
<h2>Question: What is the difference when we run <code>ls</code> in a subshell</h2>
<p>We can check the difference between these 2 commands</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>$ <span class="kw">(</span><span class="fu">ls</span><span class="kw">)</span></span></code></pre></div>
<p>By running <code>strace</code></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">strace</span> -fe execve,clone bash</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>$ <span class="kw">(</span><span class="fu">ls</span><span class="kw">)</span></span></code></pre></div>
</section>
<section id="answer-what-is-the-difference-when-we-run-ls-in-a-subshell" class="level2">
<h2>Answer: What is the difference when we run <code>ls</code> in a subshell</h2>
<p>There is no difference:</p>
<pre><code>$ ls
clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f5eea1e1850) = 865843
[pid 865843] execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;], 0x558097fc94b8 /* 76 vars */) = 0
...
$ (ls)
clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f5eea1e1850) = 865860
[pid 865860] execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;], 0x558097fc94d8 /* 76 vars */) = 0
...</code></pre>
<p><img src="assets/facepalm.jpg" /></p>
</section>
<section id="answer-what-is-the-difference-when-we-run-ls-in-a-subshell-1" class="level2">
<h2>Answer: What is the difference when we run <code>ls</code> in a subshell</h2>
<p>But actually, there is (complex commands):</p>
<pre><code>$ ls; ls
clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f5eea1e1850) = 867887
[pid 867887] execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;], 0x558097fc9528 /* 76 vars */) = 0
clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f5eea1e1850) = 867888
[pid 867888] execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;], 0x558097fc9528 /* 76 vars */) = 0
...
(ls; ls)
clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHL , child_tidptr=0x7f5eea1e1850) = 867945
[pid 867945] clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f5eea1e1850) = 867946
[pid 867946] execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;], 0x558097fc9528 /* 76 vars */) = 0
[pid 867945] execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;], 0x558097fc9528 /* 76 vars */) = 0
...</code></pre>
</section>
<section id="subshells-and-cd" class="level2">
<h2>Subshells and <code>cd</code></h2>
<p>The <code>cd</code> is not executed normally as a separate process, but with a subshell it is.</p>
<pre><code>$ cd
$ (cd)
clone(child_stack=NULL, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f5eea1e1850) = 871287
strace: Process 871287 attached
[pid 871287] +++ exited with 0 +++
--- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=871287, si_uid=1000, si_status=0, si_utime=0, si_stime=0} ---
--- SIGWINCH {si_signo=SIGWINCH, si_code=SI_KERNEL} ---</code></pre>
</section>
<section id="subshells---explanation" class="level2">
<h2>Subshells - explanation</h2>
<p>When we call the following command</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>$ <span class="kw">(</span><span class="fu">ls</span><span class="kw">;</span> <span class="fu">ls</span><span class="kw">)</span></span></code></pre></div>
<p>The following happens:</p>
<p><img src="assets/subshell.svg" /></p>
</section>
<section id="subshells---optimization" class="level2">
<h2>Subshells - optimization</h2>
<p>Bash will omit the second <code>fork()</code> is it is not neccessary.</p>
<pre><code>$ (ls)</code></pre>
<p><img src="assets/subshellsimple.svg" /></p>
</section>
<section id="different-cases-for-optimization" class="level2">
<h2>Different cases for optimization</h2>
<p>Bash omits additional <code>fork()</code>, depending on the use case.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>$ <span class="kw">(</span><span class="fu">pstree</span><span class="kw">)</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="ex">systemd</span>─┬─...</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>        ├─<span class="ex">sshd</span>───sshd───sshd───bash───pstree</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>$ <span class="kw">(</span><span class="bu">:</span><span class="kw">;</span><span class="fu">pstree</span><span class="kw">)</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="ex">systemd</span>─┬─...</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>        ├─<span class="ex">sshd</span>───sshd───sshd───bash───bash───pstree</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">bash</span> -c <span class="st">&#39;pstree&#39;</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="ex">systemd</span>─┬─...</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>        ├─<span class="ex">sshd</span>───sshd───sshd───bash───pstree</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> pstree <span class="kw">|</span> <span class="fu">bash</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="ex">systemd</span>─┬─...</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>        ├─<span class="ex">sshd</span>───sshd───sshd───bash───bash───pstree</span></code></pre></div>
</section>
<section id="operator" class="level2">
<h2>Operator <code>&lt;()</code></h2>
<p>The <code>&lt;()</code> operator works by running a command specified in brackets and inserts a temporary named pipe in their place.</p>
<p>You can see the result is a named pipe:</p>
<pre><code>$ ls -l &lt;(echo)</code></pre>
<p>For example to find <code>bash</code> in <code>ps</code> output:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">grep</span> bash <span class="op">&lt;(</span><span class="fu">ps</span><span class="op">)</span></span></code></pre></div>
<p>Or if you want to execute a script located at <code>url</code></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">bash</span> <span class="op">&lt;(</span><span class="ex">curl</span> -s https://raw.githubusercontent.com/czarnota/bash-snake/master/snake<span class="op">)</span></span></code></pre></div>
</section>
<section id="operator-1" class="level2">
<h2>Operator <code>$()</code></h2>
<p>Captures the standard output of the command in brackets and “expands” it into the shell</p>
<p>Install linux headers for current linux version:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">sudo</span> apt install linux-headers-<span class="va">$(</span><span class="fu">uname</span> -r<span class="va">)</span></span></code></pre></div>
<p>Kill <code>vim</code>, by looking up its <code>PID</code> using <code>pidof</code>:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">kill</span> <span class="va">$(</span><span class="fu">pidof</span> vim<span class="va">)</span></span></code></pre></div>
<p>Save list of files in <code>files</code> variable</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="va">files=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">ls</span> -a<span class="va">)</span><span class="st">&quot;</span></span></code></pre></div>
</section>
<section id="question-why-doesnt-it-work" class="level2">
<h2>Question: Why doesn’t it work?</h2>
<p>The <code>read</code> command reads standard input and places it in <code>var</code> variable. So <code>var</code> should contain <code>hello</code>, but it doesn’t?</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> hello <span class="kw">|</span> <span class="bu">read</span> <span class="va">var</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="st">&quot;hello:</span><span class="va">$var</span><span class="st">&quot;</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="ex">hello</span>:</span></code></pre></div>
</section>
<section id="answer-why-doesnt-it-work" class="level2">
<h2>Answer: Why doesn’t it work?</h2>
<p>The <code>echo hello | read var</code> is executed in a subshell. Execute the following commands to confirm:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">strace</span> -f -e fork,execve,clone bash</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> hello <span class="op">&gt;</span> var_value</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">read</span> <span class="va">var</span> <span class="op">&lt;</span> <span class="ex">var_value</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="st">&quot;hello:</span><span class="va">$var</span><span class="st">&quot;</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="ex">hello</span>:hello</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cat</span> var_value <span class="kw">|</span> <span class="bu">read</span> <span class="va">var2</span>         # <span class="va">read</span> <span class="va">is</span> <span class="va">done</span> <span class="va">in</span> <span class="va">a</span> <span class="va">subshell</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$var2</span></span></code></pre></div>
<p>So there is a difference between these 2 commands:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="bu">read</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="op">&lt;(</span><span class="bu">echo</span> y<span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> y <span class="kw">|</span> <span class="bu">read</span> <span class="va">x</span></span></code></pre></div>
</section>
<section id="task-search-and-replace" class="level2">
<h2>Task: Search and replace</h2>
<ol class="incremental" type="1">
<li>Imagine that you have just become the maintainer of the famous Symfony project.</li>
</ol>
<pre><code>http://github.com/symfony/symfony</code></pre>
<ol class="incremental" start="2" type="1">
<li>Currently every <code>.php</code> file has the following copyright</li>
</ol>
<pre><code>  (c) Fabien Potencier &lt;fabien@symfony.com&gt;</code></pre>
<ol class="incremental" start="3" type="1">
<li>Update the copyright by adding new line below</li>
</ol>
<pre><code>  (c) Fabien Potencier &lt;fabien@symfony.com&gt;
  (c) Your Name &lt;yourname@example.com&gt;</code></pre>
<p>You may need to use <code>sed -i</code> and <code>grep -R -l</code>.</p>
</section>
</section>
<section id="glob-patterns" class="level1">
<h1>Glob patterns</h1>
<section id="operator-2" class="level2">
<h2>Operator <code>*</code></h2>
<p>The <code>*</code> operator matches any charaters.</p>
<p>The shell will replace the pattern with all files that match it.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mv</span> *.txt dest</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> *</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> -czffiles.tar.gz *</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> -fr *.o</span></code></pre></div>
</section>
<section id="operator-3" class="level2">
<h2>Operator <code>?</code></h2>
<p>The <code>?</code> operator matches a single character.</p>
<p>The shell will replace the pattern with all files that match it.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mv</span> *.??? dest</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> *.?o</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">tar</span> -czffiles.tar.gz ??????</span></code></pre></div>
</section>
<section id="operator-4" class="level2">
<h2>Operator <code>[]</code></h2>
<p>The <code>[]</code> operator matches a single matching character from the set.</p>
<p>The shell will replace the pattern with all files that match it.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> a[bczd]</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">cp</span> *.[mp3tx][mp3tx][mp3tx]</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> [a-z]</span></code></pre></div>
</section>
<section id="operator-.." class="level2">
<h2>Operator <code>{..}</code></h2>
<p>The <code>{}</code> operator expands to numbers or characters of the specified range.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="dt">{1..10}</span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">rm</span> <span class="dt">{1..10}{1..10}</span></span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">touch</span> <span class="dt">{0..9}{a..z}</span></span></code></pre></div>
</section>
<section id="operator-5" class="level2">
<h2>Operator <code>{,}</code></h2>
<p>You can manually specify elements of the range, by specifying elements and separating them by a comma:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mv</span> path/to/<span class="dt">{file1,file2}</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">mv</span> path/to/file1.txt<span class="dt">{,.bak}</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">touch</span> path/to/<span class="dt">{przemek,mike,tom}{1..10}</span></span></code></pre></div>
</section>
<section id="operator-6" class="level2">
<h2>Operator <code>~</code></h2>
<p>The <code>~</code> expands to user’s home firectory:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> ~/directory</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/john/directory</span></span></code></pre></div>
<p>This works the same as <code>$HOME</code> variable:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$HOME</span>/directory</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/john/directory</span></span></code></pre></div>
<p>You can disable the expansion using <code>""</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="st">&quot;~/directory&quot;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="ex">~/directory</span></span></code></pre></div>
</section>
<section id="task-downloading-articles" class="level2">
<h2>Task: Downloading articles</h2>
<p>You can download an article about a day from Wikipedia in <code>.pdf</code> format from this link:</p>
<pre><code>https://en.Wikipedia.org/api/rest_v1/page/pdf/April_26</code></pre>
<ol class="incremental" type="1">
<li>Download all articles about days from the month of your birth.</li>
<li>Downloaded files should have a <code>.pdf</code> suffix.</li>
<li>Pack downloaded files into a <code>.zip</code> archive.</li>
</ol>
</section>
</section>
<section id="error-codes" class="level1">
<h1>Error codes</h1>
<section id="operator-7" class="level2">
<h2>Operator <code>||</code></h2>
<p>Executes a command only if the first command fails.</p>
<p>Print <code>not found</code>, if there is no line in <code>file</code> containing <code>hello</code>:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">grep</span> hello file <span class="kw">||</span> <span class="bu">echo</span> not found</span></code></pre></div>
<p>Download <code>file1</code>, if it fails download <code>file2</code></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">wget</span> http://a.com/file1 <span class="kw">||</span> <span class="fu">wget</span> http://b.com/file2</span></code></pre></div>
</section>
<section id="operator-8" class="level2">
<h2>Operator <code>&amp;&amp;</code></h2>
<p>Executes a command only if the first command succeeds</p>
<p>Print <code>found</code>, if there is a line in <code>file</code> containing <code>hello</code>:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">grep</span> hello file <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> found</span></code></pre></div>
<p>Remove <code>file</code> and if it was removed successfully, then create it again:</p>
<pre><code>$ rm file &amp;&amp; touch file</code></pre>
<p>Extract <code>f.tar.gz</code> archive only if it was downloaaded successfully</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">wget</span> http://x.com/f.tar.gz <span class="kw">&amp;&amp;</span> <span class="fu">tar</span> -czvf f.tar.gz</span></code></pre></div>
</section>
<section id="question-what-is-going-to-happen" class="level2">
<h2>Question: What is going to happen?</h2>
<p>What will be printed in the following scenario:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> 1 <span class="kw">||</span> <span class="bu">echo</span> 2 <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> 3</span></code></pre></div>
</section>
<section id="answer-what-is-going-to-happen" class="level2">
<h2>Answer: What is going to happen?</h2>
<p>The result is:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> 1 <span class="kw">||</span> <span class="bu">echo</span> 2 <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> 3</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span></span></code></pre></div>
<p>Although the boolean logic would suggest the following order:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> 1 <span class="kw">||</span> <span class="kw">(</span> <span class="bu">echo</span> 2 <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> 3 <span class="kw">)</span></span></code></pre></div>
<p>The actual order is always left to right:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>$ <span class="kw">(</span> <span class="kw">(</span> <span class="bu">echo</span> 1 <span class="kw">||</span>  <span class="bu">echo</span> 2 <span class="kw">)</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> 3 <span class="kw">)</span></span></code></pre></div>
</section>
</section>
<section id="writing-scripts-in-bash-programming-language" class="level1">
<h1>Writing scripts in Bash programming language</h1>
<section id="creating-and-executing-scripts" class="level2">
<h2>Creating and executing scripts</h2>
<p>A simple hello world script in Bash looks like this:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Hello World</span></code></pre></div>
<p>To execute it you need to set executable permissions</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">chmod</span> u+x script.sh</span></code></pre></div>
<p>You can execute it by specifying path to it:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./script.sh</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Hello</span> World</span></code></pre></div>
</section>
<section id="sourcing-scripts" class="level2">
<h2>Sourcing scripts</h2>
<p>You can make Bash execute the commands in a script file, without spawning a child process using <code>source</code> command or <code>.</code> command.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">source</span> s</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">.</span> <span class="ex">s</span></span></code></pre></div>
<p>Executing script normally cause a child process to be created:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./x</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="ex">clone</span>(child_stack=NULL, flags=CLONE_CHILD_CLEARTID<span class="kw">|</span><span class="ex">CLONE_CHILD_SETTID</span><span class="kw">|</span><span class="ex">SIGCHLD</span>, child_tidptr=0x7f7dd70a4890) = <span class="ex">29863</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="ex">strace</span>: Process 29863 attached</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>[<span class="ex">pid</span> 29863] execve(<span class="st">&quot;./x&quot;</span>, [<span class="st">&quot;./x&quot;</span>], 0x55c9d60a31a8 /* 50 vars */) = <span class="ex">-1</span> EACCES (Permission denied)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="ex">sh</span>: 13: ./x: Permission denied</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>[<span class="ex">pid</span> 29863] +++ exited with 126 +++</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="ex">---</span> SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=29863, si_uid=11672137, si_status=126, si_utime=0, si_stime=0} <span class="ex">---</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">---</span> SIGWINCH {si_signo=SIGWINCH, si_code=SI_KERNEL} <span class="ex">---</span></span></code></pre></div>
</section>
<section id="shebang" class="level2">
<h2>Shebang</h2>
<p>The name of the script is passed as a first argument to the program indicated by shebang.</p>
<pre><code>#!/bin/bash</code></pre>
<p>For example, below is a script, which will remove itself upon execution.</p>
<pre><code>#!/bin/rm</code></pre>
</section>
<section id="variables" class="level2">
<h2>Variables</h2>
<p>Bash scripting language supports variables. You can set a variable by assigning a value to it.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="va">variable0=</span>value</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="va">variable0=</span><span class="st">&quot;value&quot;</span></span></code></pre></div>
<p>To access a variable you can use the <code>$</code> sign.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$variable0</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${variable}</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$variable</span><span class="st">&quot;</span></span></code></pre></div>
<p>When accessing variables <code>""</code> make a difference.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="va">file=</span><span class="st">&quot;-fr /&quot;</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$file</span>        # rm <span class="st">&quot;-fr&quot;</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span>      # rm <span class="st">&quot;-fr /&quot;</span></span></code></pre></div>
</section>
<section id="variable-scope" class="level2">
<h2>Variable scope</h2>
<p>By default all variables are accessible only to a process in which they were set. To make them available to child processes you must use <code>export</code> command:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="va">var=</span>x</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">var</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="ex">./prog</span>      # prog will see the var</span></code></pre></div>
<p>You can export and set variable in one line:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">var=</span>x</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./prog</span></span></code></pre></div>
<p>You can create a variable only for the child process:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="va">var=</span>x <span class="ex">./prog</span></span></code></pre></div>
</section>
<section id="variable-scope---examples" class="level2">
<h2>Variable scope - examples</h2>
<p>The <code>visudo</code> program used the text editor specified in <code>EDITOR</code> environment variable</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="va">EDITOR=</span>nano <span class="ex">visudo</span></span></code></pre></div>
<p>The <code>make</code> program passes environment variables to Makefiles. For example you can set a compiler using <code>CC</code> variable or compiler flags using <code>CFLAGS</code> variable (if Makefile uses them)</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="va">CC=</span>clang <span class="va">CFLAGS=</span>-g <span class="fu">make</span></span></code></pre></div>
</section>
<section id="examples-of-variables-likely-available-in-your-environment" class="level2">
<h2>Examples of variables likely available in your environment</h2>
<p>Below are examples of variables, which are likely available in your environment</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$USER</span>    # current username</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$PWD</span>     # current working directory</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$RANDOM</span>  # random number</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$PATH</span>    # current program search path</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$SHELL</span>   # path to shell program</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$OLDPWD</span>  # previous directory</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$EDITOR</span>  # preferred editor</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$HOME</span>    # home directory</span></code></pre></div>
</section>
<section id="question-what-is-going-to-happen-1" class="level2">
<h2>Question: What is going to happen?</h2>
<p>What is about to happen in the below scenarios?</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>B</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="ex">A</span> = B</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span> <span class="ex">B</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>Mary <span class="ex">Had</span> a Little Lamb</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span><span class="st">&quot;Mary Had a Little Lamb&quot;</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="va">B=</span><span class="st">&quot;</span><span class="va">$A</span><span class="st">&quot;</span> <span class="va">A=</span><span class="st">&quot;</span><span class="va">$B</span><span class="st">&quot;</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="va">B=</span><span class="st">&quot;A&quot;</span> <span class="va">A=</span><span class="st">&quot;</span><span class="va">$B</span><span class="st">&quot;</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>B=<span class="ex">C</span></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>B <span class="va">B=</span>C</span></code></pre></div>
</section>
<section id="answer-what-is-going-to-happen-1" class="level2">
<h2>Answer: What is going to happen?</h2>
<p>Below is the explanation</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>B                        # <span class="ex">Variable</span> <span class="st">&#39;A&#39;</span> will have a value of <span class="st">&#39;B&#39;</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="ex">A</span> = B                      # Run <span class="st">&#39;A&#39;</span> program with <span class="st">&#39;=&#39;</span> and <span class="st">&#39;B&#39;</span> as arguments</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span> <span class="ex">B</span>                       # Run <span class="st">&#39;B&#39;</span> program with <span class="st">&#39;A&#39;</span> set to <span class="st">&#39;&#39;</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>Mary <span class="ex">Had</span> a Little Lamb   # Run <span class="st">&#39;Had&#39;</span> program with A=<span class="st">&#39;Mary&#39;</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span><span class="st">&quot;Mary Had a Little Lamb&quot;</span> # <span class="ex">Setting</span> <span class="st">&#39;A&#39;</span> to <span class="st">&#39;Mery had a Little Lamb&#39;</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="va">B=</span><span class="st">&quot;</span><span class="va">$A</span><span class="st">&quot;</span> <span class="va">A=</span><span class="st">&quot;</span><span class="va">$B</span><span class="st">&quot;</span>              # <span class="ex">Setting</span> <span class="st">&#39;B&#39;</span> to <span class="st">&#39;&#39;</span> and <span class="st">&#39;A&#39;</span> to <span class="st">&#39;&#39;</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="va">B=</span><span class="st">&quot;A&quot;</span> <span class="va">A=</span><span class="st">&quot;</span><span class="va">$B</span><span class="st">&quot;</span>               # <span class="ex">Setting</span> <span class="st">&#39;B&#39;</span> to <span class="st">&#39;B&#39;</span> and <span class="st">&#39;A&#39;</span> to <span class="st">&#39;A&#39;</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>B=<span class="ex">C</span>                      # Setting <span class="st">&#39;A&#39;</span> to <span class="st">&#39;B=C&#39;</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="va">A=</span>B <span class="va">B=</span>C                    # <span class="ex">Setting</span> <span class="st">&#39;A&#39;</span> to <span class="st">&#39;B&#39;</span> and <span class="st">&#39;B&#39;</span> to <span class="st">&#39;C&#39;</span></span></code></pre></div>
</section>
<section id="data-types---strings" class="level2">
<h2>Data types - strings</h2>
<p>Every variable is a string by default.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="va">hello=</span>world</span></code></pre></div>
<p>Numbers are also considered a string. The below statements are identical:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="va">x=</span>1</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="va">x=</span><span class="st">&quot;1&quot;</span></span></code></pre></div>
<p>You can quote contents with <code>""</code> and <code>''</code> to allow for whitespace</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="va">hello=</span><span class="st">&quot;world world&quot;</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="va">hello=</span><span class="st">&#39;world world&#39;</span></span></code></pre></div>
</section>
<section id="data-types---integers" class="level2">
<h2>Data types - integers</h2>
<p>You can declare variable as integer using <code>declare -i</code> This changes the behavior of <code>+</code> operator. Compare the below example:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">declare</span> -i <span class="va">x=</span>1</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>$ <span class="va">x=</span>1+1</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$x</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>$ <span class="va">x+=</span>1</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span></span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">declare</span> <span class="va">x=</span>1</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>$ <span class="va">x=</span>1+1</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$x</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="ex">1+1</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>$ <span class="va">x+=</span>1</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="ex">1+11</span></span></code></pre></div>
</section>
<section id="data-types---arrays" class="level2">
<h2>Data types - arrays</h2>
<p>Bash supports array. You can declare them in the following way:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="va">x=(</span>foo bar baz<span class="va">)</span></span></code></pre></div>
<p>Set and get an array element</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="va">x[1]=</span>bar</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">${x[1]}</span><span class="st">&quot;</span></span></code></pre></div>
<p>Append elements</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="va">x+=(</span>a b c d<span class="va">)</span></span></code></pre></div>
<p>You can also declare an array of integers using <code>declare -ai x=(1 2 3)</code>.</p>
</section>
<section id="data-types---array---vs" class="level2">
<h2>Data types - array - <code>@</code> vs <code>*</code></h2>
<div class="sourceCode" id="cb150"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="va">x=(</span><span class="st">&quot;john smith&quot;</span> <span class="st">&quot;mark thomson&quot;</span> <span class="st">&quot;daniel neville&quot;</span><span class="va">)</span></span></code></pre></div>
<p>You can use <code>@</code> and <code>*</code> operators to get all elements. Below is the difference between them:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="va">${x[@]}</span>   # <span class="ex">expands</span> to: john smith mark thomson daniel neville</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="va">${x[*]}</span>   # <span class="ex">expands</span> to: john smith mask thomson daniel neville</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="va">${x[@]}</span><span class="st">&quot;</span> # <span class="ex">expands</span> to: <span class="st">&quot;john smith&quot;</span> <span class="st">&quot;mark thomson&quot;</span> <span class="st">&quot;daniel neville&quot;</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="va">${x[*]}</span><span class="st">&quot;</span> # <span class="ex">expands</span> to: <span class="st">&quot;john smith mark thomson daniel neville&quot;</span></span></code></pre></div>
<p>Most of the time you probably need <code>"${x[@]}"</code>, because it expands into same number of tokens as there are elements.</p>
<p>You can also count number of array items using <code>#</code>:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="va">${#x[@]}</span></span></code></pre></div>
</section>
<section id="data-types---associative-arrays" class="level2">
<h2>Data types - associative arrays</h2>
<p>Declaring an associative array</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="bu">declare</span> -A <span class="va">x=(</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>    [<span class="ex">foo</span>]=bar</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>    [<span class="ex">bar</span>]=baz</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Assigning an element to an associative array</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="va">x[foobar]=</span>1</span></code></pre></div>
<p>Accessing all elements and all keys</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">${x[@]}</span><span class="st">&quot;</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bar</span> baz 1</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">${!x[@]}</span><span class="st">&quot;</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="ex">foo</span> bar foobar</span></code></pre></div>
</section>
<section id="conditional-staments" class="level2">
<h2>Conditional staments</h2>
<p>Bash supports <code>if</code> conditional statement.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="ex">COMMAND</span><span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="kw">elif</span> <span class="ex">COMMAND</span><span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
<p>If a <code>COMMAND</code> is successful then it will execute an <code>if</code> branch, otherwise it will fallback to <code>else</code> branch. The below example code checks if <code>john</code> is present in <code>/etc/passwd</code> file.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">grep</span> -q john /etc/passwd<span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> User exists</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> User does not exist</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
</section>
<section id="the-true-and-false-programs" class="level2">
<h2>The <code>true</code> and <code>false</code> programs</h2>
<p>The <code>true</code> is not a built-in value, instead it is implemented as program.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">true</span><span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> always visible</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
<p>Same goes for <code>false</code>:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="fu">false</span><span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> never visible</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
<p>You can negate a condition using <code>!</code></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> ! <span class="fu">false</span><span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> always visible<span class="kw">;</span> <span class="kw">fi</span></span></code></pre></div>
</section>
<section id="testing-conditions" class="level2">
<h2>Testing conditions</h2>
<p>The <code>/usr/bin/test</code> program allows can check conditions. For example to check if <code>x</code> variable equals <code>1</code>:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="bu">test</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> -eq 1<span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> x is 1</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
<p>Checking if <code>x</code> is less than one</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="bu">test</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> -lt 1<span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> x is less than 1<span class="kw">;</span> <span class="kw">fi</span></span></code></pre></div>
<p>Checking if <code>x</code> is not empty and equals <code>"foo"</code></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="bu">test</span> -n <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> -a <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> == foo<span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> pass<span class="kw">;</span> <span class="kw">fi</span></span></code></pre></div>
<p>More information is provided in <code>man test</code>.</p>
</section>
<section id="the-usrbin" class="level2">
<h2>The <code>/usr/bin/[</code></h2>
<p>The <code>test</code> is aliased as <code>/usr/bin/[</code>. Invoking it in such way requires to pass <code>]</code> as the last argument. The whole construct resembles an <code>if</code> statement from other programming languages:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span><span class="bu"> [</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> <span class="ot">-eq</span> 1<span class="bu"> ]</span>; <span class="kw">then</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> x is 1</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
<p>Checking if <code>x</code> is less than one</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span><span class="bu"> [</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> <span class="ot">-lt</span> 1<span class="bu"> ]</span>; <span class="kw">then</span> <span class="bu">echo</span> x is less than 1<span class="kw">;</span> <span class="kw">fi</span></span></code></pre></div>
<p>Checking if <code>x</code> is not empty and equals <code>"foo"</code></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> <span class="ot">-a</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> <span class="ot">==</span> <span class="st">&quot;foo&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span> <span class="bu">echo</span> pass<span class="kw">;</span> <span class="kw">fi</span></span></code></pre></div>
</section>
<section id="the-built-in-operator" class="level2">
<h2>The built-in operator <code>[[</code></h2>
<p>The operator <code>[[</code> introduces some syntactic sugar and allows you to safely omit quoting of the variables.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if [[</span> <span class="va">$x</span> <span class="ot">-eq</span> 1<span class="kw"> ]]</span>; <span class="kw">then</span>    #<span class="bu"> [</span> <span class="va">$x</span> <span class="ot">-eq</span> 1<span class="bu"> ]</span> <span class="ex">would</span> not work without quotes is <span class="va">$x</span> was empty</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> x is 1</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
<p>Checking if <code>x</code> is less than one</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if [[</span> <span class="va">$x</span> <span class="ot">-lt</span> 1<span class="kw"> ]]</span>; <span class="kw">then</span> <span class="bu">echo</span> x is less than 1<span class="kw">;</span> <span class="kw">fi</span></span></code></pre></div>
<p>Checking if <code>x</code> is not empty and equals <code>"foo"</code></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if [[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> &amp;&amp; <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span> <span class="ot">==</span> <span class="st">&quot;foo&quot;</span><span class="kw"> ]]</span>; <span class="kw">then</span> <span class="bu">echo</span> pass<span class="kw">;</span> <span class="kw">fi</span></span></code></pre></div>
<p>It is not standarized by POSIX, if portability is required use <code>[</code></p>
</section>
<section id="question-what-is-going-on-here" class="level2">
<h2>Question: What is going on here?</h2>
<p>Why this prints <code>true</code>?</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>$<span class="kw"> [[</span> 1 <span class="ot">&lt;</span> 11<span class="kw"> ]]</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> true <span class="kw">||</span> <span class="bu">echo</span> false</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">true</span></span></code></pre></div>
<p>And this prints <code>false</code>?</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>$<span class="kw"> [[</span> 2 <span class="ot">&lt;</span> 11<span class="kw"> ]]</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> true <span class="kw">||</span> <span class="bu">echo</span> false</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">false</span></span></code></pre></div>
</section>
<section id="question-what-is-going-on-here-1" class="level2">
<h2>Question: What is going on here?</h2>
<p>The below check lexicographical order.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>$<span class="kw"> [[</span> 1 <span class="ot">&lt;</span> 11<span class="kw"> ]]</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> true <span class="kw">||</span> <span class="bu">echo</span> false</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">true</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>$<span class="kw"> [[</span> 2 <span class="ot">&lt;</span> 11<span class="kw"> ]]</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> true <span class="kw">||</span> <span class="bu">echo</span> false</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="fu">false</span></span></code></pre></div>
<p>To check numeric order we still need to use</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>$<span class="kw"> [[</span> 1 <span class="ot">-lt</span> 11<span class="kw"> ]]</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> true <span class="kw">||</span> <span class="bu">echo</span> false</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">true</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>$<span class="kw"> [[</span> 2 <span class="ot">-lt</span> 11<span class="kw"> ]]</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> true <span class="kw">||</span> <span class="bu">echo</span> false</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fu">true</span></span></code></pre></div>
</section>
<section id="pattern-matching" class="level2">
<h2>Pattern matching</h2>
<p>To check if variable value starts with <code>foo</code>, you can:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="va">$x</span> <span class="ot">=</span> foo*<span class="kw"> ]]</span></span></code></pre></div>
<p>Checking if variable value ends with an even number:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="va">$x</span> <span class="ot">=</span> *[02468]<span class="kw"> ]]</span></span></code></pre></div>
<p>Checking if variable value consists of 5 characters:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="va">$x</span> <span class="ot">=</span> ?????<span class="kw"> ]]</span></span></code></pre></div>
<p>More information in Bash man page <code>man bash | grep -E "Pattern Matching$" -A 45</code></p>
</section>
<section id="extended-regular-expressions" class="level2">
<h2>Extended Regular Expressions</h2>
<p>In addition to Pattern Matching, Bash supports also the Extended Regular Expressions:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="va">$x</span> =~ ^foo.*<span class="kw"> ]]</span></span></code></pre></div>
<p>Checking if variable value ends with an even number:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="va">$x</span> =~ [02468]$<span class="kw"> ]]</span></span></code></pre></div>
<p>Checking if variable value consists of 5 characters:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="va">$x</span> =~ ^.....$<span class="kw"> ]]</span></span></code></pre></div>
</section>
<section id="arithmetic-operations" class="level2">
<h2>Arithmetic operations</h2>
<p>Evaluating an arithmetic expressions using <code>(())</code> operator:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>$ <span class="va">b=</span>1</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>$ <span class="kw">((</span>a = b + 20 / 10<span class="kw">))</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$a</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span></span></code></pre></div>
<p>Incrementing a variable:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="kw">((</span>i++<span class="kw">))</span></span></code></pre></div>
<p>Obtaining an expression value using <code>$(())</code></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>$ <span class="va">a=</span><span class="st">&quot;</span><span class="va">$((</span>1 + 1<span class="va">))</span><span class="st">&quot;</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>$ <span class="bu">echo</span> <span class="va">$((</span>a + 2<span class="va">))</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="ex">4</span></span></code></pre></div>
</section>
<section id="portable-arithmetic-operations" class="level2">
<h2>Portable arithmetic operations</h2>
<p>There are multiple ways of evaluating arithmetic operations. Additionally to the <code>(())</code> and <code>$(())</code> there are:</p>
<p>The <code>let</code> built-in:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="bu">let</span> <span class="st">&quot;x = a + b&quot;</span></span></code></pre></div>
<p>The <strong>deprecated</strong> <code>$[]</code> operator:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="va">x=</span>$[<span class="ex">a</span> + b]</span></code></pre></div>
<p>The <code>$(())</code> should be preferred if portability is required, because it is standarized by POSIX.</p>
</section>
<section id="task-converter" class="level2">
<h2>Task: Converter</h2>
<p>Create script that will convert decimals to hexadecimals and hexadecimals to decimal.</p>
<p>Example usage:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./conv</span> 0xA</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="ex">10</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./conv</span> 10</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="ex">0xA</span></span></code></pre></div>
<p>You will most likely need:</p>
<ul class="incremental">
<li><code>echo $((...))</code></li>
<li><code>printf</code></li>
<li><code>$1</code></li>
<li><code>if</code></li>
<li><code>[[ ... ]]</code> or <code>grep</code></li>
</ul>
</section>
<section id="it-is-better-to-ask-for-forgiveness-than-for-permission" class="level2">
<h2>It is better to ask for forgiveness than for permission</h2>
<p><strong>In some cases</strong> instead of checking all possible failure cases, you can attempt to execute a command and react to an error.</p>
<p>Asking for permission:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-r</span> <span class="st">&quot;f.txt&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span> f.txt</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="kw">else</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> f is not readable</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
<p>Asking for forgiveness:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> ! <span class="fu">cat</span> f.txt <span class="op">2&gt;</span> /dev/null<span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> f is not readable</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="kw">fi</span></span></code></pre></div>
</section>
<section id="while-loop" class="level2">
<h2>While loop</h2>
<p>Bash supports <code>while</code> loop</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="ex">COMMANDS</span><span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
<p>Example: running <code>ping</code> until it succeeds</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> ! <span class="fu">ping</span> -c1 10.0.0.1<span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Timeout. Retrying...&quot;</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
</section>
<section id="until-loop" class="level2">
<h2>Until loop</h2>
<p>Bash supports <code>until</code> loop</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="kw">until</span> <span class="ex">COMMANDS</span><span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
<p>Example: running <code>ping</code> until it succeeds</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="kw">until</span> <span class="fu">ping</span> -c1 10.0.0.1<span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Timeout. Retrying...&quot;</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
</section>
<section id="case-construct" class="level2">
<h2>Case construct</h2>
<p>There is a <code>case</code> statement</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="kw">case</span> VALUE<span class="kw"> in</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    PATTERN1<span class="kw">)</span> <span class="ex">COMMANDS</span> <span class="kw">;;</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">PATTERN2</span>) <span class="ex">COMMANDS</span> <span class="kw">;;</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">...</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">*</span>) <span class="ex">COMMANDS</span> <span class="kw">;;</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="kw">esac</span></span></code></pre></div>
<p>Example:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="bu">read</span> -p<span class="st">&quot;Place and order: &quot;</span> <span class="va">order</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="kw">case</span> <span class="st">&quot;</span><span class="va">$order</span><span class="st">&quot;</span><span class="kw"> in</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    fish<span class="kw">)</span> <span class="bu">echo</span> <span class="st">&quot;enjoy your fish&quot;</span> <span class="kw">;;</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">pizza</span>) <span class="bu">echo</span> <span class="st">&quot;enjoy your pizza&quot;</span> <span class="kw">;;</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">pasta</span>) <span class="bu">echo</span> <span class="st">&quot;enjoy your pasta&quot;</span> <span class="kw">;;</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">*</span>) <span class="bu">echo</span> <span class="st">&quot;sorry, we do not have it&quot;</span> <span class="kw">;;</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="kw">esac</span></span></code></pre></div>
</section>
<section id="for-...-in-...-loop" class="level2">
<h2><code>for ... in ...</code> loop</h2>
<p>The <code>for</code> loop takes a form of:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="ex">VAR</span> in TOKEN1 TOKEN2 ... TOKENN<span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
<p>Print numbers from 1 to 5</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="ex">i</span> in 1 2 3 4 5<span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
<p>Do the same using <code>seq</code></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="ex">i</span> in <span class="va">$(</span><span class="fu">seq</span> 1 5<span class="va">)</span><span class="kw">;</span> <span class="kw">do</span> <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">done</span></span></code></pre></div>
</section>
<section id="for-...-in-...-loop---more-examples" class="level2">
<h2><code>for ... in ...</code> loop - more examples</h2>
<div class="sourceCode" id="cb197"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This will print `1 2 3 4 5` once:</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="ex">i</span> in <span class="st">&quot;</span><span class="va">$(</span><span class="fu">seq</span> 1 5<span class="va">)</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span><span class="kw">;</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="co"># DIY version of `ls`</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="ex">i</span> in *<span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over script arguments</span></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="ex">i</span><span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate emails</span></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="ex">email</span> in <span class="dt">{john,jane,anna}</span>@example.com<span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$email</span><span class="st">&quot;</span></span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
</section>
<section id="for-loop" class="level2">
<h2><code>for (())</code> loop</h2>
<p>There is another version of <code>for</code> loop which is similat to <code>for</code> loop from <code>C</code> language.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="kw">((</span> expr1; expr2; expr3 <span class="kw">))</span>; <span class="kw">do</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
<p>Print numbers from <code>0</code> to <code>9</code>.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="kw">((</span>i = 0; i &lt; 10; ++i<span class="kw">))</span>; <span class="kw">do</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
<p>Print all powers of 2.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="kw">((</span>i = 1; i &gt; 0; &lt;&lt;= i<span class="kw">))</span>; <span class="kw">do</span> <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">done</span></span></code></pre></div>
</section>
<section id="loops-have-standard-input-and-standard-ouput" class="level2">
<h2>Loops have standard input and standard ouput</h2>
<p>Do-it-yourself version of <code>/usr/bin/yes</code>:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="fu">true</span><span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> y</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span> <span class="kw">|</span> <span class="fu">sudo</span> apt install <span class="va">$PACKAGES</span></span></code></pre></div>
<p>Ping every hostname in <code>/etc/hosts</code>:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/hosts <span class="kw">|</span> <span class="kw">while</span> <span class="bu">read</span> <span class="va">ip</span> <span class="va">hostname</span>; <span class="kw">do</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ping</span> -c1 <span class="st">&quot;</span><span class="va">$ip</span><span class="st">&quot;</span> <span class="op">2&gt;</span>/dev/null</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
</section>
<section id="task-create-new-files-from-directories" class="level2">
<h2>Task: Create new files from directories</h2>
<p>Create a script called <code>new</code>, which will create files from templates located in <code>~/.new</code> directory.</p>
<p>You can find templates at <a href="https://github.com/leachim6/hello-world">https://github.com/leachim6/hello-world</a></p>
<p>When user executes <code>new</code> it should list available “templates”, which are stored in <code>~/.new</code> directory and ask the user which “template” to use for a new file.</p>
<p>Example usage:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>$ ./new</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>) main.cpp</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>) main.c</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>) main.py</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>choose: <span class="dv">2</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>$ ls</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>main.c</span></code></pre></div>
<p>You can display a simple menu using <code>echo</code> and a loop or you optionally you can use <code>fzf</code> program.</p>
</section>
<section id="task-qr-code-from-clipboard" class="level2">
<h2>Task: QR code from clipboard</h2>
<p>Create an interactive program which continuously reads system clipboard and generates the QR code based on its contents.</p>
<p>You may need use the following features and programs:</p>
<ul class="incremental">
<li><code>while</code> - main program loop</li>
<li><code>sleep</code> - to pause execution for a moment</li>
<li><code>qrencode -t UTF8</code> - to generate QR code</li>
<li><code>xclip</code> - to access the clipboard</li>
<li><code>clear</code> - to clear the screen</li>
</ul>
</section>
</section>
<section id="argument-handling" class="level1">
<h1>Argument handling</h1>
<section id="accessing-arguments" class="level2">
<h2>Accessing arguments</h2>
<p>You can access arguments passed to a script using <code>${N}</code> variable, where <code>N</code> is N-th argument passed to a script. For example the <code>./script</code>:</p>
<pre><code>$ ./script a b c</code></pre>
<p>Will receive the following arguments:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$0</span> <span class="co"># ./script</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$1</span> <span class="co"># a</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$2</span> <span class="co"># b</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$3</span> <span class="co"># c</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$*</span><span class="st">&quot;</span> <span class="co"># &quot;a b c&quot;</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span> <span class="co"># &quot;a&quot; &quot;b&quot; &quot;c&quot;</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$#</span><span class="st">&quot;</span> <span class="co"># 3</span></span></code></pre></div>
<p>To access 10-th argument you need to use <code>${10}</code>.</p>
</section>
<section id="the-getopts-built-in" class="level2">
<h2>The <code>getopts</code> built-in</h2>
<p>The <code>getopts</code> build-in allows you to support POSIX short options, like <code>-a</code> or <code>-b</code>. For example to support <code>./program -a -b -c -d arg -e a b c</code> we can use the following loop:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="bu">getopts</span> <span class="st">&quot;:abcd:e&quot;</span> option<span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="st">&quot;</span><span class="va">$option</span><span class="st">&quot;</span><span class="kw"> in</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>        a<span class="kw">)</span> <span class="va">opt_a=</span>1 <span class="kw">;;</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>        b<span class="kw">)</span> <span class="va">opt_b=</span>1 <span class="kw">;;</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>        c<span class="kw">)</span> <span class="va">opt_c=</span>1 <span class="kw">;;</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>        d<span class="kw">)</span> <span class="va">opt_d=</span><span class="st">&quot;</span><span class="va">$OPTARG</span><span class="st">&quot;</span> <span class="kw">;;</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>        e<span class="kw">)</span> <span class="va">opt_e=</span>1 <span class="kw">;;</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>        :<span class="kw">)</span> <span class="bu">echo</span> <span class="st">&quot;-</span><span class="va">$OPTARG</span><span class="st"> requieres an argument&quot;</span> <span class="op">1&gt;&amp;2</span> <span class="kw">;;</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>        \<span class="ex">?</span>) <span class="bu">echo</span> <span class="st">&quot;-</span><span class="va">$OPTARG</span><span class="st"> doesn&#39;t exist&quot;</span> <span class="op">1&gt;&amp;2</span> <span class="kw">;;</span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>        <span class="ex">*</span>) <span class="bu">echo</span> <span class="st">&quot;unsuppoerted option </span><span class="va">$option</span><span class="st">&quot;</span> <span class="op">1&gt;&amp;2</span> <span class="kw">;;</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">esac</span></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a><span class="bu">shift</span> <span class="va">$((</span>OPTIND - 1<span class="va">))</span></span></code></pre></div>
<p>After <code>getopts</code> is executed once, the next argument number that will be processed is stored in <code>$OPTIND</code>. This is why at the end of the above loop, we do <code>shift $((OPTIND - 1))</code> to remove the arguments that are already parsed.</p>
</section>
<section id="parsing-long-options" class="level2">
<h2>Parsing long options</h2>
<p>Long options must be implemented manually. Below is an example for <code>./program --alfa --gamma ARG</code>. The example is not complete because it does not support <code>--gamma=ARG</code>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="fu">true</span><span class="kw">;</span> <span class="kw">do</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">arg=</span><span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="st">&quot;</span><span class="va">$arg</span><span class="st">&quot;</span><span class="kw"> in</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>        -a<span class="kw">|</span>--alfa<span class="kw">)</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">shift</span> <span class="kw">||</span> <span class="bu">break</span><span class="kw">;</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>            <span class="va">opt_alfa=</span>1 <span class="kw">;;</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>        -g<span class="kw">|</span>--gamma<span class="kw">)</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>            <span class="bu">shift</span> <span class="kw">||</span> <span class="bu">break</span><span class="kw">;</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>            <span class="va">opt_gamma=</span><span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> ! <span class="bu">shift</span><span class="kw">;</span> <span class="kw">then</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>                <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$arg</span><span class="st"> requires and argument&quot;</span> <span class="op">1&gt;&amp;2</span><span class="kw">;</span> <span class="bu">break</span></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">fi</span></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>            <span class="kw">;;</span></span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>        -*<span class="kw">)</span> <span class="bu">echo</span> <span class="st">&quot;unrecognized option: </span><span class="va">$arg</span><span class="st">&quot;</span> <span class="op">1&gt;&amp;2</span><span class="kw">;</span> <span class="bu">break</span> <span class="kw">;;</span></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>        <span class="ex">*</span>) <span class="bu">break</span> <span class="kw">;;</span></span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">esac</span></span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a><span class="kw">done</span></span></code></pre></div>
</section>
<section id="task-installing-ssh-keys" class="level2">
<h2>Task: Installing ssh keys</h2>
<p>Create script that is invoked as <code>./install-ssh-key HOST</code> and will copy your public key to <code>HOST</code> machine. If the public key does not exist it will run <code>ssh-keygen</code> and generate it.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./install-ssh-key</span> login@10.0.0.1</span></code></pre></div>
<p>After running the program it should be possible to login without password</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ssh</span> login@10.0.0.1</span></code></pre></div>
<p>Then extend the script to work for multiple machines</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./install-ssh-key</span> login@10.0.0.1 login@10.0.0.2</span></code></pre></div>
</section>
<section id="task-repeat" class="level2">
<h2>Task: Repeat</h2>
<p>Create a script named <code>repeat</code>, which will execute given command as many times as specified with <code>-n</code> parameter</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./repeat</span> -n 3 echo foo bar baz</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="ex">foo</span> bar baz</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="ex">foo</span> bar baz</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="ex">foo</span> bar baz</span></code></pre></div>
<p><strong>Very important</strong>: arguments must be correctly processed. This should create single file <code>"x y z"</code> 3 times:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">./repeat</span> -t 3 touch <span class="st">&quot;x y z&quot;</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>$ <span class="fu">ls</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;x y z&quot;</span></span></code></pre></div>
</section>
<section id="task-self-extracting-archive" class="level2">
<h2>Task: Self extracting archive</h2>
<p>Create a script called <code>tarpack</code>, which accepts a <code>.tar.gz</code> archive as a first argument and produces a script (name as a second argument), which will act as a “self-extracting” archive.</p>
<p>We should be able turn an archive into a script, then remove the archive.</p>
<pre><code>$ ./tarpack archive.tar.gz foo.sh
$ rm archive.tar.gz</code></pre>
<p>And finally unpack the archive:</p>
<pre><code>$ ./foo.sh</code></pre>
<p>You may need:</p>
<ul class="incremental">
<li><code>base64</code></li>
</ul>
</section>
<section id="task-find-and-open" class="level2">
<h2>Task: find and open</h2>
<p>Create a script that will look for files, which name contains the string passed as the first argument. The script will print a choice menu with matched files. After the user selects an option, the script will open the selected file in the editor specified by <code>$EDITOR</code> environment variable. If variable is not specified it should fall back to <code>vi</code></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>$ <span class="va">EDITOR=</span>name <span class="ex">f</span> foo</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span>) <span class="ex">foobar</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span>) <span class="ex">barfoo</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span>) <span class="ex">afoo</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="ex">choice</span>: 2</span></code></pre></div>
</section>
</section>
<section id="functions" class="level1">
<h1>Functions</h1>
<section id="defining-functions" class="level2">
<h2>Defining functions</h2>
<p>In Bash functions are declared by specifying their name followed by <code>()</code></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">function_name ()</span> <span class="kw">{</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">return</span> EXIT_CODE</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<p>There is also an alternate syntax that is equivalent to the previous one.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span><span class="fu"> function_name</span> <span class="kw">{</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">return</span> EXIT_CODE</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<p>You can call a function by specifying its name:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="ex">function_name</span></span></code></pre></div>
</section>
<section id="functions-and-subshells" class="level2">
<h2>Functions and subshells</h2>
<p>By default a function is executed within the same bash process. We can however call a function in a subshell.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">function_name</span><span class="kw">)</span></span></code></pre></div>
<p>Alternatively we can define a function using <code>(  )</code> brackets instead of <code>{  }</code>. This way the function will always be called in a subshell.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="kw">()</span> <span class="kw">(</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">COMMANDS</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">return</span> EXIT_CODE</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span></code></pre></div>
<pre><code>function_name</code></pre>
</section>
<section id="function-arguments" class="level2">
<h2>Function arguments</h2>
<p>A function, just like a script can accept arguments. You can access them using same variables as in the case of script arguments.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">foo ()</span> <span class="kw">{</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$1</span> <span class="va">$2</span> <span class="va">$3</span> <span class="co"># a b c</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$*</span><span class="st">&quot;</span> <span class="co"># &quot;a b c&quot;</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span> <span class="co"># &quot;a&quot; &quot;b&quot; &quot;c&quot;</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$#</span> <span class="co"># 3</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">$0</span> <span class="co"># program_name (not function name)</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
<p>Calling function with arguments:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="ex">foo</span> a b c</span></code></pre></div>
</section>
<section id="local-variables" class="level2">
<h2>Local variables</h2>
<p>A local variable can be declared using <code>local</code>.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">foo ()</span> <span class="kw">{</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">x</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">x=</span>1</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">y=</span>1</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$x</span><span class="st">&quot;</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a><span class="va">x=</span>2</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="va">y=</span>2</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="ex">foo</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$x</span> <span class="co"># prints 2</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$y</span> <span class="co"># prints 1</span></span></code></pre></div>
<p>Instead of <code>local</code> you can also use <code>declare</code>. If <code>declare</code> is used in function scope then it creates local variable. To create global variable from the scope of function you need to use <code>declare -g</code>. There is also <code>readonly</code>, but it behaves like <code>declare -gr</code> (variable will not be local).</p>
</section>
<section id="question-what-will-be-displayed" class="level2">
<h2>Question: what will be displayed?</h2>
<div class="sourceCode" id="cb225"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">a ()</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$var</span><span class="st">&quot;</span> <span class="kw">}</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">b ()</span> <span class="kw">{</span> <span class="bu">local</span> <span class="va">var=</span><span class="st">&quot;local value&quot;</span>; <span class="ex">a</span><span class="kw">;</span> <span class="kw">}</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="va">var=</span><span class="st">&quot;global value&quot;</span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="ex">a</span>   # outputs ???</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="ex">b</span>   # outputs ???</span></code></pre></div>
</section>
<section id="answer-what-will-be-displayed" class="level2">
<h2>Answer: what will be displayed?</h2>
<p><strong>Bash uses dynamic scoping</strong>. <strong>The value of var in child is not determined by where child is defined, but by where it is called.</strong> If there is no local definition in the body of child, the next place the shell looks is in the body of the function from which child is called, and so forth. The local modifier creates a variable in a function that is local to that call, so it does not affect the value of the variable from any enclosing scopes. It is, though, visible to any enclosed scope (<a href="https://stackoverflow.com/a/40659060">https://stackoverflow.com/a/40659060</a>).</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">a ()</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$var</span><span class="st">&quot;</span> <span class="kw">}</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">b ()</span> <span class="kw">{</span> <span class="bu">local</span> <span class="va">var=</span><span class="st">&quot;local value&quot;</span>; <span class="ex">a</span><span class="kw">;</span> <span class="kw">}</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="va">var=</span><span class="st">&quot;global value&quot;</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="ex">a</span>   # outputs <span class="st">&quot;global valaue&quot;</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="ex">b</span>   # outputs <span class="st">&quot;local value&quot;</span></span></code></pre></div>
</section>
<section id="handling-arguments-in-functions" class="level2">
<h2>Handling arguments in functions</h2>
<p>It is a good practive to assign arguments to variables, to document their meaning.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">introduce ()</span> <span class="kw">{</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">name=</span><span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span>;</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">surname=</span><span class="st">&quot;</span><span class="va">$2</span><span class="st">&quot;</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">age=</span><span class="st">&quot;</span><span class="va">$3</span><span class="st">&quot;</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$name</span><span class="st"> </span><span class="va">$surname</span><span class="st"> </span><span class="va">$age</span><span class="st">&quot;</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a><span class="ex">introduce</span> Przemysław Czarnota 29</span></code></pre></div>
<p>Problems with this approach:</p>
<ul class="incremental">
<li>the body of the function will be executed regardless of whether the number of provided arguments is correct;</li>
<li>adding a new argument in the middle requires to update all arguments that follow it;</li>
<li>reordering arguments requires updating the argument numbers, which is prone to errors.</li>
</ul>
</section>
<section id="better-handling-arguments-in-functions" class="level2">
<h2>Better handling arguments in functions</h2>
<p>To overcome the mentioned problems, we can improve the argument handling</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">introduce ()</span> <span class="kw">{</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">name=</span><span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span>; <span class="bu">shift</span> <span class="kw">||</span> <span class="bu">return</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">surname=</span><span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span>; <span class="bu">shift</span> <span class="kw">||</span> <span class="bu">return</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">age=</span><span class="st">&quot;</span><span class="va">${1-</span>not disclosed<span class="va">}</span><span class="st">&quot;</span>; <span class="bu">shift</span> <span class="kw">||</span> <span class="fu">true</span> <span class="co"># optional arguments</span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$name</span><span class="st"> </span><span class="va">$surname</span><span class="st"> </span><span class="va">$age</span><span class="st">&quot;</span></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a><span class="ex">introduce</span> Przemysław Czarnota 29</span></code></pre></div>
<ul class="incremental">
<li>all required arguments must be provided to a function in order for the body to execude;</li>
<li>adding a new argument in the middle does not require update of the following lines;</li>
<li>reordering arguments is done by just reordering lines.</li>
</ul>
</section>
<section id="handling-standard-input-and-standard-output-in-functions" class="level2">
<h2>Handling standard input and standard output in functions</h2>
<p>The functions receive standard input and print to standard output.</p>
<p>For example the <code>tr</code> command will receive the same standard input that was passed to the function and will print to the same standard output that was set for the function</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">to_lower ()</span> <span class="kw">{</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tr</span> <span class="st">&#39;[[:upper:]]&#39;</span> <span class="st">&#39;[[:lower:]]&#39;</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Przemek <span class="kw">|</span> <span class="ex">to_lower</span></span></code></pre></div>
<p>Results in:</p>
<pre><code>przemek</code></pre>
</section>
<section id="task-bookmarks" class="level2">
<h2>Task: Bookmarks</h2>
<p>Create script <code>./bookmarks.sh</code> and source it in your <code>~/.bashrc</code>. The <code>./bookmarks.sh</code> should define a function called <code>goto</code>, which allows the user to navigate and create bookmarks.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save current working directory as a new bookmark under the same name as directory</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">goto</span> +</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Same as the above but the bookmark will be called `foo`</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">goto</span> + foo</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change directory `cd` to the `foo` bookmark</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">goto</span> foo</span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Should return an errorcode and print a message to standard error</span></span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a><span class="co"># that the &#39;asd&#39; bookmark does not exist</span></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">goto</span> asd </span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a><span class="co"># List all bookmarks</span></span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a>$ <span class="ex">goto</span></span></code></pre></div>
<p>Bookmarks can be implemented as symbolic links in the <code>~/.goto</code> directory.</p>
</section>
</section>
<section id="thank-you" class="level1">
<h1>Thank you</h1>
</section>
<script>
/*!	
* FitText.js 1.0 jQuery free version
*
* Copyright 2011, Dave Rupert http://daverupert.com 
* Released under the WTFPL license 
* http://sam.zoy.org/wtfpl/
* Modified by Slawomir Kolodziej http://slawekk.info
*
* Date: Tue Aug 09 2011 10:45:54 GMT+0200 (CEST)
*/
(function(){

  var addEvent = function (el, type, fn) {
    if (el.addEventListener)
      el.addEventListener(type, fn, false);
		else
			el.attachEvent('on'+type, fn);
  };
  
  var extend = function(obj,ext){
    for(var key in ext)
      if(ext.hasOwnProperty(key))
        obj[key] = ext[key];
    return obj;
  };

  window.fitText = function (el, kompressor, options) {

    var settings = extend({
      'minFontSize' : -1/0,
      'maxFontSize' : 1/0
    },options);

    var fit = function (el) {
      var compressor = kompressor || 1;

      var resizer = function () {
        el.style.fontSize = Math.max(Math.min(el.clientWidth / (compressor*10), parseFloat(settings.maxFontSize)), parseFloat(settings.minFontSize)) + 'px';
      };

      // Call once to set.
      resizer();

      // Bind events
      // If you have any js library which support Events, replace this part
      // and remove addEvent function (or use original jQuery version)
      addEvent(window, 'resize', resizer);
      addEvent(window, 'orientationchange', resizer);
    };

    if (el.length)
      for(var i=0; i<el.length; i++)
        fit(el[i]);
    else
      fit(el);

    // return set of elements
    return el;
  };
})();

    fitText(document.querySelectorAll('.level2'), 5);
    fitText(document.querySelectorAll('h1'), 2.5);

    document.querySelectorAll('p > img').forEach(e => e.parentNode.style.overflow="hidden");

</script>
  </body>
</html>
